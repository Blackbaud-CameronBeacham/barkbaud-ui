!function(){"use strict";function a(a,b,c){a.html5Mode(!1),b.otherwise(function(a){var b=a.get("$state");b.go("dashboard")}),c.productName="Barkbaud"}function b(a,b,c,e,f){function g(a){return d.apiUrl+a}e.$on("$stateChangeStart",function(a,b,d){var g;c.authenticated||(a.preventDefault(),e.$emit("bbBeginWait"),g=f.href(b,d,{absolute:!0}),c.isAuthenticated().then(function(a){e.$emit("bbEndWait"),a?f.go(b,d):c.modal(g).then(function(){return f.go(b.name,d)})}))}),e.$on("bbBeginWait",function(a,c){a.stopPropagation(),b.beginPageWait(c)}),e.$on("bbEndWait",function(a,c){a.stopPropagation(),b.endPageWait(c)}),a.dataUrlFilter=g,a.resourceUrlFilter=g}function c(a){var b=this;b.logout=a.logout}var d={apiUrl:"https://glacial-mountain-6366.herokuapp.com/"};a.$inject=["$locationProvider","$urlRouterProvider","bbWindowConfig"],b.$inject=["bbDataConfig","bbWait","barkbaudAuthService","$rootScope","$state"],c.$inject=["barkbaudAuthService"],angular.module("barkbaud",["sky","ui.bootstrap","ui.router","ngAnimate","barkbaud.templates"]).constant("barkbaudConfig",d).config(a).run(b).controller("MainController",c)}(),function(){"use strict";function a(){return{scope:{barkPhotoUrl:"="},link:function(a,b){a.$watch("barkPhotoUrl",function(a){a&&b.css("background-image","url('"+a.replace("http://","https://")+"')")})},replace:!0,templateUrl:"components/photo.html"}}angular.module("barkbaud").directive("barkPhoto",a)}(),function(){"use strict";function a(a){a.state("dashboard",{controller:"DashboardPageController as dashboardPage",templateUrl:"pages/dashboard/dashboardpage.html",url:"/dashboard"})}function b(a,b,c,d){var e=this;a.$emit("bbBeginWait"),d.setWindowTitle("Dashboard"),c.load({data:"api/dogs"}).then(function(b){e.dogs=b.data.data,a.$emit("bbEndWait")})}a.$inject=["$stateProvider"],b.$inject=["$scope","$stateParams","bbData","bbWindow"],angular.module("barkbaud").config(a).controller("DashboardPageController",b)}(),function(){"use strict";function a(a,b,c){var d=this;b.load({data:"api/dogs/"+encodeURIComponent(c)+"/currenthome"}).then(function(a){d.currentHome=a.data})}a.$inject=["$timeout","bbData","dogId"],angular.module("barkbaud").controller("DogCurrentHomeTileController",a)}(),function(){"use strict";function a(a){a.state("dog",{"abstract":!0,controller:"DogPageController as dogPage",templateUrl:"pages/dogs/dogpage.html",url:"/dogs/:dogId",resolve:{dogId:["$stateParams",function(a){return a.dogId}]}}).state("dog.views",{url:"",views:{currenthome:{controller:"DogCurrentHomeTileController as dogCurrentHomeTile",templateUrl:"pages/dogs/currenthome/currenthometile.html"},previoushomes:{controller:"DogPreviousHomesTileController as dogPreviousHomesTile",templateUrl:"pages/dogs/previoushomes/previoushomestile.html"},notes:{controller:"DogNotesTileController as dogNotesTile",templateUrl:"pages/dogs/notes/notestile.html"}}})}function b(a,b,c,d,e){var f=this;f.tiles=[{id:"DogCurrentHomeTile",view_name:"currenthome",collapsed:!1,collapsed_small:!1},{id:"DogPreviousHomesTile",view_name:"previoushomes",collapsed:!1,collapsed_small:!1},{id:"DogNotesTile",view_name:"notes",collapsed:!1,collapsed_small:!1}],f.layout={one_column_layout:["DogCurrentHomeTile","DogPreviousHomesTile","DogNotesTile"],two_column_layout:[["DogCurrentHomeTile","DogPreviousHomesTile"],["DogNotesTile"]]},a.$emit("bbBeginWait"),c.load({data:"api/dogs/"+encodeURIComponent(e)}).then(function(b){f.dog=b.data.data,d.setWindowTitle(f.dog.name),a.$emit("bbEndWait")})}a.$inject=["$stateProvider"],b.$inject=["$scope","$stateParams","bbData","bbWindow","dogId"],angular.module("barkbaud").config(a).controller("DogPageController",b)}(),function(){"use strict";function a(){}function b(a){return{open:function(){return a.open({controller:"NoteAddController as noteAdd",templateUrl:"pages/dogs/notes/noteadd.html"})}}}b.$inject=["bbModal"],angular.module("barkbaud").controller("NoteAddController",a).factory("barkNoteAdd",b)}(),function(){"use strict";function a(a,b,c,d,e){var f=this;b.load({data:"api/dogs/"+encodeURIComponent(e)+"/notes"}).then(function(a){f.notes=a.data.data}),f.getNoteDate=function(a){return a&&a.iso?c(a.iso).calendar():void 0},f.addNote=function(){d.open()}}a.$inject=["$timeout","bbData","bbMoment","barkNoteAdd","dogId"],angular.module("barkbaud").controller("DogNotesTileController",a)}(),function(){"use strict";function a(a,b,c){var d=this;b.load({data:"api/dogs/"+encodeURIComponent(c)+"/previoushomes"}).then(function(a){d.previousHomes=a.data.data}),d.getSummaryDate=function(a){return a&&a.iso?bbMoment(a.iso).format("MMM Do YY"):void 0}}a.$inject=["$timeout","bbData","dogId"],angular.module("barkbaud").controller("DogPreviousHomesTileController",a)}(),function(){"use strict";function a(a,b,c,d){var e=this;b.load({data:"api/dogs/"+encodeURIComponent(d)+"/summary"}).then(function(a){e.summary=a.data.data}),e.getSummaryDate=function(a){return a&&a.iso?c(a.iso).format("MMM Do YY"):void 0}}a.$inject=["$timeout","bbData","bbMoment","dogId"],angular.module("barkbaud").controller("DogSummaryTileController",a)}(),function(){"use strict";function a(a,b,c,d,e,f){var g=this;g.error=a.search().error,g.logout=e.logout,g.login=function(){e.login(f)},d.setWindowTitle("Login"),g.waitingForAuth=!0,e.isAuthenticated().then(function(a){g.waitingForAuth=!1,a&&e.update(a)})}a.$inject=["$location","$window","bbWait","bbWindow","barkbaudAuthService","barkbaudRedirect"],angular.module("barkbaud").controller("LoginPageController",a)}(),function(){"use strict";function a(a,b,c,d,e){function f(b,c){e.location.href=[a.apiUrl,"auth/",b,"?redirect=",encodeURIComponent(c)].join("")}var g,h={};return h.isAuthenticated=function(){var a=d.defer();return b.load({data:"auth/authenticated"}).then(function(b){h.authenticated=b.data.authenticated,a.resolve(b.data.authenticated)}),a.promise},h.login=function(a){f("login",a)},h.logout=function(a){f("logout",a)},h.update=function(){g.close(h.authenticated)},h.modal=function(a){return g||(g=c.open({controller:"LoginPageController as loginPage",templateUrl:"pages/login/loginpage.html",resolve:{barkbaudRedirect:function(){return a}}})),g.result},h}a.$inject=["barkbaudConfig","bbData","bbModal","$q","$window"],angular.module("barkbaud").factory("barkbaudAuthService",a)}(),angular.module("barkbaud.templates",[]).run(["$templateCache",function(a){a.put("components/photo.html",'<div class="bark-dog-photo img-circle center-block">\n</div>\n'),a.put("pages/dashboard/dashboardpage.html",'<div class="container-fluid">\n  <h1>Dashboard</h1>\n  <section class="panel" ng-repeat="dog in dashboardPage.dogs">\n    <div class="panel-body">\n      <div class="row">\n          <div class="col-md-3 col-lg-2">\n            <a ui-sref="dog.views({dogId: dog.objectId})">\n              <bark-photo bark-photo-url="dog.image.url"></bark-photo>\n            </a>\n          </div>\n          <div class="col-md-9 col-lg-10">\n              <h1>\n                <a ui-sref="dog.views({dogId: dog.objectId})">{{dog.name}}</a>\n              </h1>\n              <h4>{{dog.breed}} &middot; {{dog.gender}}</h4>\n              <p class="bb-text-block bark-dog-bio">{{dog.bio}}</p>\n          </div>\n      </div>\n    </div>\n  </section>\n</div>\n'),a.put("pages/dogs/currenthome/currenthometile.html","<bb-tile bb-tile-header=\"'Current home'\">\n    <div bb-tile-section>\n        {{dogCurrentHomeTile.currentHome.constituent.name}}\n    </div>\n</bb-tile>\n"),a.put("pages/dogs/dogpage.html",'<div class="bb-page-header">\n    <div class="container-fluid">\n        <div class="row">\n            <div class="col-md-3 col-lg-2">\n                <bark-photo bark-photo-url="dogPage.dog.image.url"></bark-photo>\n            </div>\n            <div class="col-md-9 col-lg-10">\n                <h1>\n                  {{dogPage.dog.name}}\n                </h1>\n                <h4>{{dogPage.dog.breed}} &middot; {{dogPage.dog.gender}}</h4>\n                <p></p>\n                <p class="bb-text-block bark-dog-bio">{{dogPage.dog.bio}}</p>\n            </div>\n        </div>\n    </div>\n</div>\n<div class="container-fluid">\n    <bb-tile-dashboard bb-layout="dogPage.layout" bb-tiles="dogPage.tiles"></bb-tile-dashboard>\n</div>\n'),a.put("pages/dogs/notes/noteadd.html",'<bb-modal>\n  <div class="modal-form">\n    <bb-modal-header>Add note</bb-modal-header>\n    <div bb-modal-body>\n      <form>\n        <div class="form-group">\n          <label class="control-label">Date</label>\n          <bb-datepicker type="text" ng-model="noteAdd.date"></bb-date-picker>\n        </div>\n        <div class="form-group">\n          <label class="control-label">Note</label>\n          <input type="text" class="form-control" ng-model="noteAdd.title" />\n        </div>\n        <div class="form-group">\n          <textarea class="form-control" ng-model="noteAdd.description"></textarea>\n        </div>\n        <div class="form-group">\n          <label class="control-label">\n            <input type="checkbox" bb-check ng-model="noteAdd.addConstituentNote" />\n            Also add this note to the dog\'s current owner\n          </label>\n        </div>\n      </form>\n    </div>\n    <bb-modal-footer>\n      <bb-modal-footer-button-primary></bb-modal-footer-button-primary>\n      <bb-modal-footer-button-cancel></bb-modal-footer-button-cancel>\n    </bb-modal-footer>\n  </div>\n</bb-modal>\n'),a.put("pages/dogs/notes/notestile.html",'<bb-tile bb-tile-header="\'Notes\'">\n  <div>\n    <div class="toolbar bb-tile-toolbar">\n      <button type="button" class="btn bb-btn-secondary" ng-click="dogNotesTile.addNote()"><i class="fa fa-plus-circle"></i> Add Note</button>\n    </div>\n    <div ng-show="dogNotesTile.notes">\n      <div ng-switch="dogNotesTile.notes.length || 0">\n        <div bb-tile-section ng-switch-when="0" class="bb-no-records">\n          This dog has no notes.\n        </div>\n        <div ng-switch-default class="bb-repeater">\n          <div ng-repeat="note in dogNotesTile.notes" class="bb-repeater-item">\n            <h4 class="bb-repeater-item-title">{{ note.title }}</h4>\n            <h5>{{ dogNotesTile.getNoteDate(note.date) }}</h5>\n            <p>{{ note.description }}</p>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</bb-tile>\n'),a.put("pages/dogs/previoushomes/previoushomestile.html",'<bb-tile bb-tile-header="\'Previous homes\'">\n  <div>\n    <div ng-show="dogSummaryTile.previousHomes">\n      <div ng-switch="dogSummaryTile.previousHomes.length || 0">\n        <div bb-tile-section ng-switch-when="0" class="bb-no-records">\n          This dog has no previous homes.\n        </div>\n        <div ng-switch-default class="bb-repeater">\n          <div ng-repeat="previousHome in dogSummaryTile.previousHomes" class="bb-repeater-item">\n            <h4 class="bb-repeater-item-title">{{ previousHome.constituent.name }}</h4>\n            <h5>\n              {{ dogSummaryTile.getSummaryDate(previousHome.fromDate) }}\n              <span ng-show="previousHome.toDate">\n                to {{ dogSummaryTile.getSummaryDate(previousHome.toDate) }}\n              </span>\n            </h5>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</bb-tile>\n'),a.put("pages/login/loginpage.html",'<bb-modal>\n  <div class="modal-form">\n    <bb-modal-header>Barkbaud</bb-modal-header>\n    <div bb-modal-body>\n      <p class="alert alert-danger" ng-if="loginPage.error" ng-switch="loginPage.error">\n        <span ng-switch-when="access_denied">\n          Barkbaud requires access to RENXT.\n        </span>\n        <span ng-switch-default>\n          An unknown error has occurred.\n        </span>\n      </p>\n      <p>Welcome to the Barkbaud Sample App.  This demo was built to showcase the Blackbaud NXT API and Blackbaud Sky UX.</p>\n      <p>Click the Login button below to view the demo, or click the Learn More button below to visit the GitHub repo.</p>\n    </div>\n    <bb-modal-footer>\n      <div ng-show="loginPage.waitingForAuth">\n        <i class="fa fa-2x fa-spin fa-spinner" ></i> Checking authentication...\n      </div>\n      <div ng-hide="loginPage.waitingForAuth">\n        <bb-modal-footer-button-primary  ng-click="loginPage.login()">\n          Authorize Barkbaud\n        </bb-modal-footer-button-primary>\n        <a href="https://github.com/blackbaud/barkbaud" target="_blank" class="btn bb-btn-secondary">\n          Learn More\n        </a>\n      </div>\n    </bb-modal-footer>\n  </div>\n</bb-modal>\n')}]);
//# sourceMappingURL=app.min.js.map